{% extends "base.html" %}
{% load ads_tag %}
{% load utils_tags %}

{% block title %}{{ site.name }} | Proposer un bien{% endblock %}

{% block media %}
	{{ form.media }}
{% endblock %}

{% block javascript %}
	<script>
		$(document).ready(function(){
			var habitation_type = $('#id_habitation_type').val();
			var correspondance = ['apartment', 'house', '', '', '', '', '', 'parking', 'others'];
			//var habitation_type_display = correspondance[parseInt(habitation_type)]
			function init_form(){
				$('.atom').each(function(evt){
					console.log($(this), habitation_type)
					if(habitation_type != ''){
						if(!$(this).hasClass(correspondance[parseInt(habitation_type)])){
							$(this).hide()
							// erase values
							$(this).find(':input').val('').removeAttr('checked').removeAttr('selected')
						}else{
							$(this).show()
						}
					}
					else{
						if(!$(this).hasClass('base')){
							$(this).hide()
						}
					}
				})
			}
						
			$('#id_habitation_type').change(function(evt){
				habitation_type = $(this).val()
				//habitation_type_display = correspondance[parseInt(habitation_type)]
				//console.log(habitation_type_display)
				init_form()
			})
			
			init_form()
		})
	</script>
{% endblock %}


{% block main_menu %}
	<a href="{% url search %}" class="main_menu_item_unselected">Rechercher un bien</a>
	<a href="{% url add %}" class="main_menu_item_selected" >Proposer un bien</a>
{% endblock %}

{% block content %}
	<form action="" method="POST" class="pretty_form" enctype="multipart/form-data">
		<div class="form_adson" style="margin-top:0px;">
		Les champs obligatoires sont identifiés par une <span style="color:red">*</span>.
		<br />Nous vous conseillons de renseigner le maximum de champs, 
		d'être exhaustif dans votre description et de fournir un plan de votre bien et plusieurs photos.
		En effet, les acheteurs sont plus attirés par les biens pour lesquels la description est complète 
		et seront mieux à même de cibler les biens susceptibles de vraiment correspondre à leurs besoins. 
		Les acheteurs qui vous contacteront seront ainsi les plus susceptibles d'être vraiment intéressés 
		par votre bien, cela vous évitera de nombreux appels passés à titre informatifs ou des visites 
		superflues qui auront peu de chance d'aboutir.	
		</div>
	
	<div class="form">
		{% csrf_token %}	
		{% if form.non_field_errors %}{{ form.non_field_errors }}{% endif %}
		{% for fieldset in form.fieldsets %}
		  {% if fieldset.name != 'description' %}
		    
		  <div class="atom {{ fieldset.classes }}">
		  {% if fieldset.legend %}
		    <h2 class="hightlight_title">{{ fieldset.legend }}</h2>
		  {% endif %}
		  {% if fieldset.description %}
		    <p class="description">{{ fieldset.description }}</p>
		  {% endif %}
		  <table>
		  {% for field in fieldset %}
			{% if field.is_hidden %}
		      {{ field }}
		    {% else %}
			{% ifequal field.name 'location' %}
			
			

			
			<tr>
				<th>{{ field.label_tag }}</th>
				<td>
				<div >{{ field }} 
					{% if field.help_text %}<br />
						{% autoescape off %}<span class="help">{{ field.help_text }}</span>{% endautoescape %}
						{% endif %}
						{% if field.errors %}<br />{{ field.errors }}{% endif %}	
					</div>
					<div style="clear:both"></div>
				</td>
			</tr>
			

			
			{% else %}
			
			
			{% if field.field.widget|widget_type == 'CheckboxInput' or field.field.widget|widget_type == 'BooleanExtendedNumberInput' %}
		      <tr{{ field.row_attrs }}>
		        <th>
					
				</th>
		        <td>
					{{ field }} {% if field.field.widget|widget_type == 'CheckboxInput' %} <span class="checkbox_label">{{ field.label_tag }}</span> {% endif %}
					{% if field.errors %}<br />{{ field.errors }} {% endif %}
					{% if field.help_text %}<br />
						{% autoescape off %}<span class="help">{{ field.help_text }}</span>{% endautoescape %}
					{% endif %}
				</td>
		      </tr>

			{% else %}
		      <tr{{ field.row_attrs }}>
		        <th>
					{{ field.label_tag }}
				</th>
		        <td>
					{% if field.field.required %}<div class="required_class" style="float:right">*</div>{% endif %}
					<span>{{ field }}</span>
					{% if field.errors %}<br />{{ field.errors }} {% endif %}
					{% if field.help_text %}<br />
						{% autoescape off %}<span class="help">{{ field.help_text }}</span>{% endautoescape %}
					{% endif %}
				</td>
		      </tr>
			{% endif %}
		    {% endifequal %}
		    {% endif %}
		  	{% endfor %}

		  </table>
		  </div>
			{% endif %}
		{% endfor %}

		<div class="atom house apartment parking others">
			<h2 class="hightlight_title">Photos</h2>
			<p>N'hésitez pas à insérer une photo du plan de votre bien.</p>
			    {{ picture_formset.management_form }}
    		<ul style="list-style:none">
        		{% for form in picture_formset %}
        		<li class="upload_picture" style="margin-bottom:10px">
					{% comment %}{{ form.id }} {{ form.DELETE }} {{ form.title }} {{ form.image }} {% endcomment %}
					
					<table>
						<tr><th style="text-align:left; font-size:1em">Photo n° {{ forloop.counter }}</th><td></td></tr>
						{{ form }}
					</table>
				</li>
        		{% endfor %}
    		</ul>
		</div>
		<div style="clear:both"></div>
		
		<div class="atom {{ form.fieldsets.description.classes }}">
			<h2 class="hightlight_title">{{ form.fieldsets.description.legend }}</h2>
		  <table>
		  {% for field in form.fieldsets.description %}
			{% if field.is_hidden %}
		      {{ field }}
		    {% else %}
			
		      <tr{{ field.row_attrs }}>
		        <td>
					{{ field.label_tag }}
				</td>
		        <td>
					{{ field }} 
					{% if field.errors %}<br />{{ field.errors }} {% endif %}
					{% if field.help_text %}<br />
						{% autoescape off %}<span class="help">{{ field.help_text }}</span>{% endautoescape %}
					{% endif %}
				</td>
		      </tr>
		    {% endif %}
		  	{% endfor %}
		  </table>
		</div>
<table>
<tr class="last">
	<th></th>
	<td><button type="submit">Envoyer</button></td>
</tr>
</table>


        
	</div>
    </form>
{% endblock %}